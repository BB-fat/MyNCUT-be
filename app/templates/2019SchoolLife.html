<head>
    <link rel="stylesheet" href="static/2019SchoolLife/css/swiper.min.css">
    <link rel="stylesheet" href="static/2019SchoolLife/css/style.css">
    <link rel="stylesheet" href="static/2019SchoolLife/css/animate.css">
    <link rel="stylesheet" href="static/2019SchoolLife/css/chart.css">
</head>


<body>

<img id="audio_btn" class="rotate" src="static/2019SchoolLife/img/play.png">
<audio loop src="static/2019SchoolLife/mp3/mp3.mp3" id="media" autoplay=""></audio>

{% if data.sex==0 %}
<img id="person" class="person" src="static/2019SchoolLife/img/girl.png">
<img hidden="true" id="person-jump" class="person" src="static/2019SchoolLife/img/girljumpbig.gif">
{% else %}
<img id="person" class="person" src="static/2019SchoolLife/img/boy.png">
<img hidden="true" id="person-jump" class="person" src="static/2019SchoolLife/img/boyjumpbig.gif">
{% endif %}

<div class="swiper-container">
    <div class="swiper-wrapper">
        <!--        第一页-->
        <div class="swiper-slide page0">
            <img class="stone" src="static/2019SchoolLife/img/1-stone.png">
            <img class="bgimg" src="static/2019SchoolLife/img/background.png">
            <div class="page0-count-div">
                你是第<em>{{data.count}}</em>个打开这份记录的人
            </div>
            <div style="height: 70px;"></div>
            <div class="page0-text-div">
                <text class="text">工大不大 , 四年却很长</text>
                <text class="text">足够你用脚印丈量每一段距离 ;</text>
                <text class="text">工大很大 , 但四年不长</text>
                <text class="text">等待你将生活在这里的每一刻细细品尝</text>
                <text class="text">时光肆意流 , 工大点滴留</text>
                <text class="text">你和工大的故事还在记录着</text>
                <text class="text">...</text>
                <text class="text">点滴校园 , 时间看得见</text>
            </div>
        </div>
        <!--第二页-->
        <div class="swiper-slide">
            <img class="bgimg" src="static/2019SchoolLife/img/background.png">
            <img class="trip" src="static/2019SchoolLife/img/trip.png">
            <div class="page1-text-div">
                <!--                <em>2019年7月</em>,</br>-->
                <!--                一纸录取通知书从北方工业大学</br>-->
                <!--                来到你的身边</br>-->

                <p>你来自<em>{{data.city}}</em>，</p>
                学校有一共<em>{{data.same_name_school}}</em>人和你来自于同一个地方</br>
                其中和你一个学院的有<em>{{data.same_name_college}}</em>人
            </div>
        </div>
        <!--第三页-->
        <div class="swiper-slide">
            <img class="bgimg" src="static/2019SchoolLife/img/background.png">
            <img class="dunpin" src="static/2019SchoolLife/img/dunpin.png">
            <div class="page2-text-div">
                记得刚刚踏进校门的那个夏天，<br/>
                <p>阳光正好。<br/></p>
                你上的第一门课程是在<em>敦品楼</em>的<em>体育课</em><br/>
                <p>那天的你青涩却笃定，向往着不远的未来。</p>
            </div>
        </div>
        <!--第四页-->
        <div class="swiper-slide">
            <div class="page3-text-div">
                <div style="margin-top: 300px;"></div>
                <text class="text"> 一定是特别的缘分，</text>
                <text class="text"> 你的名字是<em>{{data.name}}</em></text>
                {%if data.same_name!=0%}
                <text class="text">学校一共有<em>{{data.same_name}}</em>人与你同名同姓。</text>
                {%else%}
                <text class="text">你是全校唯一一个叫做<em>{{data.name}}</em>的人。</text>
                {%endif%}
                <div style="margin-top: 150px"></div>
                <text class="text"> 学校一共有<em>{{data.same_day_school}}</em>人与你同一天出生。</text>
                {%if data.same_day_and_year!=0%}
                <text class="text"> 其中有<em>{{data.same_day_and_year}}</em>人与你同年同月同日。</text>
                {%endif%}
                <text class="text"> 期待在一个玉兰花开的日子里，与 ta 相识。</text>
            </div>
            <img class="garden" src="static/2019SchoolLife/img/garden.png">
            <img class="bgimg" src="static/2019SchoolLife/img/background.png">
        </div>
        <!--        第五页-->
        <div class="swiper-slide">
        </div>
        <!--        第六页-->
        <div class="swiper-slide">
            <div class="page5-text-div">
                <p>无数次连接 NCUT-AUTO，
                <P><br>无数次与校园网作斗争。</p>
                <p><br>估计连你自己都惊讶，</p>
                <br>你一共使用了<em>{{data.school_net_sum}}G</em>的校园流量。
            </div>
            <img class="computer" src="static/2019SchoolLife/img/computer.png">
            <img class="bgimg" src="static/2019SchoolLife/img/background.png">
        </div>
        <!--        第七页-->
        <div class="swiper-slide">
            <div class="page6-text-div">
                每天的各个时段，<br> 你的校园网用量都不太相同，<br> 那天晚上，<br> 你好像睡得格外的晚 ...
            </div>
<!--            校园网分时段用量图表-->
            <canvas id="net-map"></canvas>
            <img class="computer" src="static/2019SchoolLife/img/computer.png">
            <img class="bgimg" src="static/2019SchoolLife/img/background.png">
        </div>
        <!--        第八页-->
        <div class="swiper-slide">
            <img class="bgimg" src="static/2019SchoolLife/img/background.png">
            <img class="dunpin" src="static/2019SchoolLife/img/hanxue.png">
            <div class="page7-text-div">
                你在五教台阶低头驻足，在博远桥上仰望星空。<br/>
                一花一木，一草一树，<br/>
                你在熟悉的校园里生活学习。<br/>
                你一共完成了<em>{{data.grades[1]}}门</em>课程，<br/>
                共计<em>{{data.grades[2]}}学分</em><br/>
                你成绩最好的一门课程是<em>{{data.grades[3]}}</em>，总评<em>{{data.grades[4]}}分</em><br/>
                <br/>现在的努力和奋斗，未来的故事和期许，同工大的记忆一起，藏进校园点滴。
            </div>
        </div>
        <!--        第九页-->
        <div class="swiper-slide">
            <img class="bgimg" src="static/2019SchoolLife/img/background.png">
            <img class="money" src="static/2019SchoolLife/img/money.png">
            <div class="page8-text-div">
                时光温酒，岁月磨镜，<br/>
                一张校园卡是工大点滴的通行证。<br/>
                <p>不知道你是否关注过，<br/></p>
                你一共刷卡消费了<em>{{data.sum_consum_times}}次</em>，<br/>
                总计<em>{{data.sum_consum_money}}元</em>。<br/>
            </div>
        </div>
        <!--        第十页-->
        <div class="swiper-slide">
            <img class="bgimg" src="static/2019SchoolLife/img/background.png">
            <img class="dining" src="static/2019SchoolLife/img/dining.png">
            <div class="page9-text-div">
                不可辜负的，是工大的美食。<br>
                你在(食堂)消费<em>{{data.consum_dining_hall_sum}}元</em>，你最爱的食堂是<em>{{data.consum_dining_hall[0][0]}}</em>。<br>
                <p>相信来日阔别工大，<br></p>
                怀念更多的是舌尖上的那抹味道。
            </div>
            <div class="chartBack">
                <div class="skillbar clearfix " data-percent="{{data.consum_dining_hall[0][3]}}%">
                    <div class="skillbar-title" style="background: #d35400;width: 200px"><span>{{data.consum_dining_hall[0][0]}}</span>
                    </div>
                    <div class="skillbar-bar" style="background: #e67e22;width: 200px"></div>
                    <div class="skill-bar-percent">￥{{data.consum_dining_hall[0][2]}}</div>
                </div> <!-- End Skill Bar -->

                <div class="skillbar clearfix " data-percent="{{data.consum_dining_hall[1][3]}}%">
                    <div class="skillbar-title" style="background: #2980b9;width: 200px"><span>{{data.consum_dining_hall[1][0]}}</span>
                    </div>
                    <div class="skillbar-bar" style="background: #3498db;width: 200px"></div>
                    <div class="skill-bar-percent">￥{{data.consum_dining_hall[1][2]}}</div>
                </div> <!-- End Skill Bar -->

                <div class="skillbar clearfix " data-percent="{{data.consum_dining_hall[2][3]}}%">
                    <div class="skillbar-title" style="background: #27ae60;width: 200px"><span>{{data.consum_dining_hall[2][0]}}</span>
                    </div>
                    <div class="skillbar-bar" style="background: #2ecc71;width: 200px"></div>
                    <div class="skill-bar-percent">￥{{data.consum_dining_hall[2][2]}}</div>
                </div> <!-- End Skill Bar -->
                <div class="skillbar clearfix " data-percent="{{data.consum_dining_hall[3][3]}}%">
                    <div class="skillbar-title" style="background: #27ae60;width: 200px"><span>{{data.consum_dining_hall[3][0]}}</span>
                    </div>
                    <div class="skillbar-bar" style="background: #2ecc71;width: 200px"></div>
                    <div class="skill-bar-percent">￥{{data.consum_dining_hall[3][2]}}</div>
                </div> <!-- End Skill Bar -->
            </div>
        </div>
    </div>
</div>
</div>

<script src="static/2019SchoolLife/js/swiper.min.js"></script>
<script src="static/2019SchoolLife/js/move.min.js"></script>
<script src="static/2019SchoolLife/js/jQuery.js"></script>
<script src="static/2019SchoolLife/js/jquery.fittext.js"></script>
<script src="static/2019SchoolLife/js/jquery.lettering.js"></script>
<script src="static/2019SchoolLife/js/jquery.textillate.js"></script>
<script src="static/2019SchoolLife/js/jweixin-1.2.0.js"></script>
<script>
    var LineChart = function (options) {

        var data = options.data;
        var canvas = document.getElementById("net-map")
        var context = canvas.getContext('2d');

        var rendering = false,
            paddingX = 40,
            paddingY = 40,
            width =800,
            height = 400,
            progress = 0;

        canvas.width = width;
        canvas.height = height;

        var maxValue,
            minValue;

        var y1 = paddingY + (0.05 * (height - (paddingY * 2))),
            y2 = paddingY + (0.50 * (height - (paddingY * 2))),
            y3 = paddingY + (0.95 * (height - (paddingY * 2)));

        format();
        render();

        function format(force) {

            maxValue = 0;
            minValue = Number.MAX_VALUE;

            data.forEach(function (point, i) {
                maxValue = Math.max(maxValue, point.value);
                minValue = Math.min(minValue, point.value);
            });

            data.forEach(function (point, i) {
                point.targetX = paddingX + (i / (data.length - 1)) * (width - (paddingX * 2));
                point.targetY = paddingY + ((point.value - minValue) / (maxValue - minValue) * (height - (paddingY * 2)));
                point.targetY = height - point.targetY;

                if (force || (!point.x && !point.y)) {
                    point.x = point.targetX + 30;
                    point.y = point.targetY;
                    point.speed = 0.04 + (1 - (i / data.length)) * 0.05;
                }
            });

        }

        function render() {

            if (!rendering) {
                requestAnimationFrame(render);
                return;
            }

            context.font = '10px sans-serif';
            context.clearRect(0, 0, width, height);


            if (options.yAxisLabel) {
                context.save();
                context.globalAlpha = progress;
                context.translate(paddingX - 15, height - paddingY - 10);
                context.rotate(-Math.PI / 2);
                context.fillStyle = '#fff';
                context.fillText(options.yAxisLabel, 0, 0);
                context.restore();
            }

            var progressDots = Math.floor(progress * data.length);
            var progressFragment = (progress * data.length) - Math.floor(progress * data.length);

            data.forEach(function (point, i) {
                if (i <= progressDots) {
                    point.x += (point.targetX - point.x) * point.speed;
                    point.y += (point.targetY - point.y) * point.speed;

                    context.save();

                    var wordWidth = context.measureText(point.label).width;
                    context.globalAlpha = i === progressDots ? progressFragment : 1;
                    context.fillStyle = point.future ? '#aaa' : '#000';
                    context.fillText(point.label, point.x - (wordWidth / 2), height - 18);

                    if (i < progressDots && !point.future) {
                        context.beginPath();
                        context.arc(point.x, point.y, 4, 0, Math.PI * 2);
                        context.fillStyle = '#1baee1';
                        context.fill();
                    }//顶点颜色

                    context.restore();
                }

            });

            context.save();
            context.beginPath();
            context.strokeStyle = '#1baee1';//线条的颜色
            context.lineWidth = 2;

            var futureStarted = false;

            data.forEach(function (point, i) {

                if (i <= progressDots) {

                    var px = i === 0 ? data[0].x : data[i - 1].x,
                        py = i === 0 ? data[0].y : data[i - 1].y;

                    var x = point.x,
                        y = point.y;

                    if (i === progressDots) {
                        x = px + ((x - px) * progressFragment);
                        y = py + ((y - py) * progressFragment);
                    }

                    if (point.future && !futureStarted) {
                        futureStarted = true;

                        context.stroke();
                        context.beginPath();
                        context.moveTo(px, py);
                        context.strokeStyle = '#aaa';

                        if (typeof context.setLineDash === 'function') {
                            context.setLineDash([2, 3]);
                        }
                    }

                    if (i === 0) {
                        context.moveTo(x, y);
                    } else {
                        context.lineTo(x, y);
                    }

                }

            });

            context.stroke();
            context.restore();

            progress += (1 - progress) * 0.02;

            requestAnimationFrame(render);

        }

        this.start = function () {
            rendering = true;
        }

        this.stop = function () {
            rendering = false;
            progress = 0;
            format(true);
        }

        this.restart = function () {
            this.stop();
            this.start();
        }

        this.append = function (points) {
            progress -= points.length / data.length;
            data = data.concat(points);

            format();
        }

        this.populate = function (points) {
            progress = 0;
            data = points;

            format();
        }

    };

    var chart = new LineChart({data: []});

    reset();

    // chart.start();

    function append() {
        chart.append([
            {label: 'Rnd', value: 1300 + (Math.random() * 1500), future: true}
        ]);
    }

    function restart() {
        chart.restart();
    }
    function reset() {
  chart.populate([
    { label: '00:00', value: {{data.school_net_day[0][2]}} },
    { label: '01:00', value: {{data.school_net_day[1][2]}} },
    { label: '02:00', value: {{data.school_net_day[2][2]}} },
    { label: '03:00', value: {{data.school_net_day[3][2]}} },
    { label: '04:00', value: {{data.school_net_day[4][2]}} },
    { label: '05:00', value: {{data.school_net_day[5][2]}} },
    { label: '06:00', value: {{data.school_net_day[6][2]}} },
    { label: '07:00', value: {{data.school_net_day[7][2]}} },
    { label: '08:00', value: {{data.school_net_day[8][2]}} },
    { label: '09:00', value: {{data.school_net_day[9][2]}} },
    { label: '10:00', value: {{data.school_net_day[10][2]}} },
    { label: '11:00', value: {{data.school_net_day[11][2]}} },
    { label: '12:00', value: {{data.school_net_day[12][2]}} },
    { label: '13:00', value: {{data.school_net_day[13][2]}} },
    { label: '14:00', value: {{data.school_net_day[14][2]}} },
    { label: '15:00', value: {{data.school_net_day[15][2]}} },
    { label: '16:00', value: {{data.school_net_day[16][2]}} },
    { label: '17:00', value: {{data.school_net_day[17][2]}} },
    { label: '18:00', value: {{data.school_net_day[18][2]}} },
    { label: '19:00', value: {{data.school_net_day[19][2]}} },
    { label: '20:00', value: {{data.school_net_day[20][2]}} },
    { label: '21:00', value: {{data.school_net_day[21][2]}} },
    { label: '22:00', value: {{data.school_net_day[22][2]}} },
    { label: '23:00', value: {{data.school_net_day[23][2]}} },

  ]);
}
</script>
<script src="static/2019SchoolLife/js/main.js"></script>

</body>