            <head>
            	<link rel="stylesheet" href="static/2019SchoolLife/css/swiper.min.css">
            	<link rel="stylesheet" href="static/2019SchoolLife/css/style.css">
            	<link rel="stylesheet" href="static/2019SchoolLife/css/animate.css">
            	<link rel="stylesheet" href="static/2019SchoolLife/css/chart.css">
            </head>


            <body>


            	<img id="girl" class="girl" src="static/2019SchoolLife/img/girl.png">
            	<div class="swiper-container">
            		<div class="swiper-wrapper">
            			<div class="swiper-slide page0">
            				<img class="stone" src="static/2019SchoolLife/img/stone.png">
            				<img class="bgimg" src="static/2019SchoolLife/img/ground.png">
            			</div>
            			<div class="swiper-slide page1">
            				<img class="library" src="static/2019SchoolLife/img/library.png">
            				<img class="bgimg" src="static/2019SchoolLife/img/ground.png">
            			</div>
            			<div class="swiper-slide page2">
            				<div class="text" style="opacity: 0;">
            					岁月荏苒，花开花灭，又是一年毕业季。如今即将各奔东西的大家，还记得四年前刚刚迈入大学校园的，青涩懵懂的你们吗？
            				</div>
            			</div>
            			<div class="swiper-slide page3">                        
            				<div id="audio_btn" class="rotate">
            					<img id="audio_btn" class="rotate" src="static/2019SchoolLife/img/2.png" alt="">
            					<audio loop src="static/2019SchoolLife/mp3/mp3.mp3" id="media" autoplay="" preload=""></audio>

            				</div>
            				<canvas width=640 height=1008 id="thecanvas" style="display: none;"></canvas>

            				<button id="saveImageBtn">生成定制图片</button>
            				<img id="save_img" src="" alt="">
            			</div>
            			<div class="swiper-slide page4">
            				<div class="chartBack">
            					<div class="skillbar clearfix " data-percent="{{data.dining_hall[0][3]}}%">
            						<div class="skillbar-title" style="background: #d35400;"><span>{{data.dining_hall[0][0]}}</span></div> 
            						<div class="skillbar-bar" style="background: #e67e22;"></div>
            						<div class="skill-bar-percent">￥{{data.dining_hall[0][2]}}</div>
            					</div> <!-- End Skill Bar -->

            					<div class="skillbar clearfix " data-percent="{{data.dining_hall[1][3]}}%">
            						<div class="skillbar-title" style="background: #2980b9;"><span>{{data.dining_hall[1][0]}}</span></div>
            						<div class="skillbar-bar" style="background: #3498db;"></div>
            						<div class="skill-bar-percent">￥{{data.dining_hall[1][2]}}</div>
            					</div> <!-- End Skill Bar -->

            					<div class="skillbar clearfix " data-percent="{{data.dining_hall[2][3]}}%">
            						<div class="skillbar-title" style="background: #27ae60;"><span>{{data.dining_hall[2][0]}}</span></div>
            						<div class="skillbar-bar" style="background: #2ecc71;"></div>
            						<div class="skill-bar-percent">￥{{data.dining_hall[2][2]}}</div>
            					</div> <!-- End Skill Bar -->
            				</div>
            			</div>
            		</div>
            	</div>

            	<script src="static/2019SchoolLife/js/swiper.min.js"></script>
            	<script src="static/2019SchoolLife/js/move.min.js"></script>
            	<script src="static/2019SchoolLife/js/jQuery.js"></script>
            	<script src="static/2019SchoolLife/js/jquery.fittext.js"></script>
            	<script src="static/2019SchoolLife/js/jquery.lettering.js"></script>
            	<script src="static/2019SchoolLife/js/jquery.textillate.js"></script>
            	<script src="static/2019SchoolLife/js/jweixin-1.2.0.js"></script>
            	<script> 
            		var mySwiper = new Swiper('.swiper-container', {
                            direction: 'vertical', // 垂直切换选项
                            loop: false, // 循环模式选项
                            speed: 1200,
                            on: {
                            	touchStart: function (e) {
                            		var girl = document.getElementById("girl")
                            		girl.src = "static/2019SchoolLife/img/girljumpbig.gif"
                            	},
                            	transitionEnd: function () {
                            		var girl = document.getElementById("girl")
                            		girl.src = "static/2019SchoolLife/img/girl.png"
                            	},
                            	slideChange: function () {
                            		if (this.activeIndex == 2) {
                            			move('.text')
                            			.set('opacity', '1')
                            			.end();
                            			$('.text')
                            			.fitText(3.2, { minFontSize: '45px', maxFontSize: '50px' })
                            			.textillate({
                            				loop: false,
                            				in: { effect: 'flipInX' }
                            			});
                            		} else if (this.activeIndex == 3) {
                            			var myImage = document.getElementById("canvas");
                            			var cxt = myImage.getContext("2d");
                            			var img = new Image();
                            			img.src = "static/2019SchoolLife/img/123.jpg";
                            			img.onload = function () {
                            				cxt.drawImage(img, 0,0);
                            				cxt.strokeText("要写的文字", 50, 50);
                            			};
                            			cxt.font = "30px bold 黑体";
                                            // 设置颜色
                                            cxt.fillStyle = "#111111";
                                            // 设置水平对齐方式
                                            cxt.textAlign = "center";
                                            // 设置垂直对齐方式
                                            cxt.textBaseline = "middle";
                                            // 绘制文字（参数：要写的字，x坐标，y坐标）
                                            // Converts canvas to an image
                                            var img = document.getElementById("saveimg");
                                            var tempSrc = canvas.toDataURL("image/png");
                                            img.src=tempSrc;   
                                            girl.hidden=true
                                        }
                                        else if (this.activeIndex == 4) {
                                        	jQuery('.skillbar').each(function(){
                                        		jQuery(this).find('.skillbar-bar').animate({
                                        			width:jQuery(this).attr('data-percent')
                                        		},6000);
                                        	});
                                        }
                                    },
                                }
                            })
                        </script>
                        <!-- music -->
                        <script>

                        	var $audio = $('#media')[0];
                        	wx.config({
                            debug: false, // 这里为false
                            appId: '', // 以下随意填写即可
                            timestamp: (new Date()).getTime(),
                            nonceStr: '',
                            signature: '',
                            jsApiList: ['checkJsApi']
                        });
                        	wx.ready(function () {
                        		$audio.play();
                        	});
                        	var x = document.getElementById("media");
                        	$(function () {

                        		$("#audio_btn").click(function () {
                                $(this).toggleClass("rotate"); //控制音乐图标 自转或暂停

                                //控制背景音乐 播放或暂停            
                                if ($(this).hasClass("rotate")) {
                                	x.play();
                                } else {
                                	x.pause();
                                }
                            })
                        	});
                        </script>
                        <script>
                        	window.onload = function() {
                        		draw();
                        		var saveButton = document.getElementById("saveImageBtn");
                        		bindButtonEvent(saveButton, "click", saveImageInfo);
                        		var dlButton = document.getElementById("downloadImageBtn");
                        		bindButtonEvent(dlButton, "click", saveAsLocalImage);
                        	};
                        	function draw(){
                        		var myImage = document.getElementById("thecanvas");
                        		var cxt = myImage.getContext("2d");
                        		var img = new Image();
                        		img.src = "static/2019SchoolLife/img/123.jpg";
                        		img.onload = function () {
                        			cxt.drawImage(img, 0,0);
                        			cxt.strokeText("要写的文字", 50, 50);
                        		};
                        		cxt.font = "15px bold 黑体";
                                            // 设置颜色
                                            cxt.fillStyle = "#111111";
                                            // 设置水平对齐方式
                                            cxt.textAlign = "center";
                                            // 设置垂直对齐方式
                                            cxt.textBaseline = "middle";
                                            // 绘制文字（参数：要写的字，x坐标，y坐标）
                                            // Converts canvas to an image
                                        };

                                        function bindButtonEvent(element, type, handler)
                                        {
                                        	if(element.addEventListener) {
                                        		element.addEventListener(type, handler, false);
                                        	} else {
                                        		element.attachEvent('on'+type, handler);
                                        	}
                                        }

                                        function saveImageInfo () 
                                        {
                                        	var img = document.getElementById("save_img");
                                        	var mycanvas = document.getElementById("thecanvas");
                                        	var image    = mycanvas.toDataURL("image/png");
                                        	img.src = 'image';
                                        	var w=window.open('about:blank','image from canvas');
                                        	w.document.write("<center><img src='"+image+"' alt='from canvas'/></center>");
                                        }

                                        function saveAsLocalImage () {
                                        	var myCanvas = document.getElementById("thecanvas");
                            // here is the most important part because if you dont replace you will get a DOM 18 exception.
                            // var image = myCanvas.toDataURL("image/png").replace("image/png", "image/octet-stream;Content-Disposition: attachment;filename=foobar.png");
                            var image = myCanvas.toDataURL("image/png").replace("image/png", "image/octet-stream"); 
                            window.location.href=image; // it will save locally
                        }
                    </script>
                </body>

