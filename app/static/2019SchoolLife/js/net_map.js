var LineChart=function(p){var h=p.data;var e=document.getElementById("net-map");var d=e.getContext("2d");var q=false,g=40,f=40,c=p.width||window.innerWidth,o=p.height||window.innerHeight,a=0;e.width=c;e.height=o;var i,m;var l=f+(0.05*(o-(f*2))),k=f+(0.5*(o-(f*2))),j=f+(0.95*(o-(f*2)));n();b();function n(r){i=0;m=Number.MAX_VALUE;h.forEach(function(s,t){i=Math.max(i,s.value);m=Math.min(m,s.value)});h.forEach(function(s,t){s.targetX=g+(t/(h.length-1))*(c-(g*2));s.targetY=f+((s.value-m)/(i-m)*(o-(f*2)));s.targetY=o-s.targetY;if(r||(!s.x&&!s.y)){s.x=s.targetX+30;s.y=s.targetY;s.speed=0.04+(1-(t/h.length))*0.05}})}function b(){if(!q){requestAnimationFrame(b);return}d.font="10px sans-serif";d.clearRect(0,0,c,o);if(p.yAxisLabel){d.save();d.globalAlpha=a;d.translate(g-15,o-f-10);d.rotate(-Math.PI/2);d.fillStyle="#fff";d.fillText(p.yAxisLabel,0,0);d.restore()}var s=Math.floor(a*h.length);var t=(a*h.length)-Math.floor(a*h.length);h.forEach(function(u,w){if(w<=s){u.x+=(u.targetX-u.x)*u.speed;u.y+=(u.targetY-u.y)*u.speed;d.save();var v=d.measureText(u.label).width;d.globalAlpha=w===s?t:1;d.fillStyle=u.future?"#aaa":"#000";d.fillText(u.label,u.x-(v/2),o-18);if(w<s&&!u.future){d.beginPath();d.arc(u.x,u.y,4,0,Math.PI*2);d.fillStyle="#1baee1";d.fill()}d.restore()}});d.save();d.beginPath();d.strokeStyle="#1baee1";d.lineWidth=2;var r=false;h.forEach(function(v,A){if(A<=s){var z=A===0?h[0].x:h[A-1].x,w=A===0?h[0].y:h[A-1].y;var u=v.x,B=v.y;if(A===s){u=z+((u-z)*t);B=w+((B-w)*t)}if(v.future&&!r){r=true;d.stroke();d.beginPath();d.moveTo(z,w);d.strokeStyle="#aaa";if(typeof d.setLineDash==="function"){d.setLineDash([2,3])}}if(A===0){d.moveTo(u,B)}else{d.lineTo(u,B)}}});d.stroke();d.restore();a+=(1-a)*0.02;requestAnimationFrame(b)}this.start=function(){q=true};this.stop=function(){q=false;a=0;n(true)};this.restart=function(){this.stop();this.start()};this.append=function(r){a-=r.length/h.length;h=h.concat(r);n()};this.populate=function(r){a=0;h=r;n()}};var chart=new LineChart({data:[]});reset();chart.start();function append(){chart.append([{label:"Rnd",value:1300+(Math.random()*1500),future:true}])}function restart(){chart.restart()};